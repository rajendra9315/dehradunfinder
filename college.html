<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title id="metaTitle">College in Dehradun</title>
  <meta name="description" id="metaDesc" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>

<div class="form-wrapper">
  <h2 id="collegeName"></h2>
  <p id="collegeDesc"></p>

  <h4>Popular Courses</h4>
  <ul id="courses"></ul>

  <a href="lead-form.html">
    <button>Apply for Admission</button>
  </a>
</div>

<!-- Static college list (fallback) -->
<script src="js/colleges-data.js"></script>

<script>
  const params = new URLSearchParams(window.location.search);
  const slug = params.get("slug");

  if (!slug) {
    document.body.innerHTML = "<h2>College not found</h2>";
  } else {

    // ðŸ”¹ 1ï¸âƒ£ TRY TO LOAD AI DATA FIRST
    fetch(`/api/get-college?slug=${slug}`)
      .then(res => {
        if (!res.ok) throw new Error("AI data not found");
        return res.json();
      })
      .then(data => {
        // âœ… AI DATA FOUND
        document.getElementById("collegeName").innerText = data.name;
        document.getElementById("collegeDesc").innerText = data.description;

        document.title = data.seo_title;
        document
          .querySelector('meta[name="description"]')
          .setAttribute("content", data.seo_description);

        const coursesList = document.getElementById("courses");
        coursesList.innerHTML = "";
        data.courses.forEach(course => {
          const li = document.createElement("li");
          li.innerText = course;
          coursesList.appendChild(li);
        });
      })
      .catch(() => {
        // ðŸ”¹ 2ï¸âƒ£ FALLBACK TO STATIC DATA
        const college = colleges.find(c => c.slug === slug);

        if (!college) {
          document.body.innerHTML = "<h2>College not found</h2>";
          return;
        }

        document.getElementById("collegeName").innerText = college.name;
        document.getElementById("collegeDesc").innerText =
          `${college.name} is one of the reputed colleges in Dehradun offering quality education.`;

        document.title = `${college.name} | Best College in Dehradun`;

        document
          .querySelector('meta[name="description"]')
          .setAttribute(
            "content",
            `${college.name} â€“ courses, fees, admission details and placements.`
          );

        document.getElementById("courses").innerHTML =
          "<li>B.Tech</li><li>MBA</li><li>BCA</li>";
      });
  }
</script>

</body>
</html>
